= ATLAS - Service Point Export Service API Guide
:doctype: book
:compat-mode:
:page-layout!:
:toc: left
:toclevels: 3
:sectanchors:
:sectlinks:
:linkattrs:
:icons: font
:table-caption!:
:source-highlighter: highlightjs
:highlightjsdir: highlight
:revnumber: {version}

[[abstract]]
= Overview

=== Project information

[width="60%" cols="18%,35%" ]
|=================================
|Application Name | {name}
|Version | {version}
|Build-Time| {buildTime}
|=================================

=== Developer Portal

This API is available as a part of the ATLAS API on the SBB developer portal.

- Production: https://developer.sbb.ch/apis/atlas/information
- Lower Stages are available here: https://developer-int.sbb.ch/apis?all=&text=atlas&scopes=PUBLIC;INTERNAL

=== Release Notes

include::../release-notes.adoc[]

= Export

This service exports the following data:

*Service Point Directory*:

* *Service Point Versions*
* *Traffic Point Element Versions*
* *Loading Point Versions*

*PRM (Person with Reduced Mobility) Directory*:

* *Stop Point Versions*
* *Platform Versions*
* *Reference Point Versions*
* *Contact Point Versions*
* *Toilet Versions*
* *Parking Lot Versions*
* *Relation Versions*

include::../../../../base-atlas/documentation/servicepoint/when_to_use_files_or_API.adoc[]

include::../../../../base-atlas/documentation/amazon/Amazon_S3_Buckets_Users_Onboarding.adoc[]

== Service Point Directory

=== Unsuccessfully Examples

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-get-json-unsuccessfully/atlas-doc.adoc[]

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-gzip-json-unsuccessfully/atlas-doc.adoc[]

=== Service Point Versions

Service Point Versions data is available via the ServicePoint API or as a File (CSV or JSON) via the Export Service Point API or through the Amazon S3 Bucket Client (CSV and JSON).

The Export Service Point generates nightly the following zipped CSV and gzipped JSON files:

* WORLD FULL
* WORLD ONLY ACTUAL DATE
* WORLD ONLY FUTURE TIMETABLE
* SWISS FULL
* SWISS ONLY ACTUAL DATE
* SWISS ONLY FUTURE TIMETABLE

If you want to consume this files you have two options:

* Via API: see following section
* Through the Amazon S3 Bucket Client: see **Atlas Amazon S3 Bucket Users onboarding**

==== Data Mapping Migration from DiDok to ATLAS

See https://confluence.sbb.ch/x/GI3aj to get additional information about the data mapping migration from DiDok to ATLAS.

=== Trigger export Service Point Versions

include::{snippets}/export-service-point-batch-controller-api-v1-integration-test/should-post-service-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Service Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-get-service-point-json-successfully/atlas-doc.adoc[]

=== Download Service Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-service-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Service Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-service-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Service Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-service-point-gzip-json-successfully/curl-request.adoc[]

=== Traffic Point Element Versions

Traffic Point Element Versions data is available via the ServicePoint API or as a File (CSV or JSON) via the Export Service Point API or through the Amazon S3 Bucket Client (CSV and JSON).

The Export Service Point Directory generates nightly the following zipped CSV and gzipped JSON files:

* WORLD FULL
* WORLD ONLY ACTUAL DATE
* WORLD ONLY FUTURE TIMETABLE

If you want to consume this files you have two options:

* Via API: see following section
* Through the Amazon S3 Bucket Client: see **Atlas Amazon S3 Bucket Users onboarding**

==== Data Mapping Migration from DiDok to ATLAS

See https://confluence.sbb.ch/x/PB1Xl to get additional information about the data mapping migration from DiDok to ATLAS.

=== Trigger export Traffic Point Element Versions

include::{snippets}/export-service-point-batch-controller-api-v1-integration-test/should-post-traffic-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Traffic Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-get-traffic-point-json-successfully/atlas-doc.adoc[]

=== Download Traffic Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-traffic-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Traffic Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-traffic-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Traffic Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-traffic-point-gzip-json-successfully/curl-request.adoc[]

=== Loading Point Versions

Loading Point Versions data is available via the ServicePoint API or as a File (CSV or JSON) via the Export Service Point API or through the Amazon S3 Bucket Client (CSV and JSON).

The Export Service Point Directory generates nightly the following zipped CSV and gzipped JSON files:

* WORLD FULL
* WORLD ONLY ACTUAL DATE
* WORLD ONLY FUTURE TIMETABLE

If you want to consume this files you have two options:

* Via API: see following section
* Through the Amazon S3 Bucket Client: see **Atlas Amazon S3 Bucket Users onboarding**

==== Data Mapping Migration from DiDok to ATLAS

See https://confluence.sbb.ch/x/6R_uj to get additional information about the data mapping migration from DiDok to ATLAS.

=== Trigger export Loading Point Versions

include::{snippets}/export-service-point-batch-controller-api-v1-integration-test/should-post-loading-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Loading Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-get-loading-point-json-successfully/atlas-doc.adoc[]

=== Download Loading Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-loading-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Loading Point Json - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-loading-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Loading Point Gzip (Json) - Successfully

include::{snippets}/service-point-batch-controller-api-v1-integration-test/should-download-latest-loading-point-gzip-json-successfully/curl-request.adoc[]

== PRM (Person with Reduced Mobility) Directory

PRM data is available via the PRM-Directory API or as a File (CSV or JSON) via the Export PRM API or through the Amazon S3 Bucket Client (CSV and JSON).

The Export PRM Service generates nightly the following zipped CSV and gzipped JSON files for all PRM-Objects:

* FULL
* ACTUAL DATE
* FUTURE TIMETABLE

If you want to consume this files you have two options:

* Via API: see following sections
* Through the Amazon S3 Bucket Client: see **Atlas Amazon S3 Bucket Users onboarding**

=== Unsuccessfully Examples

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-json-unsuccessfully/atlas-doc.adoc[]

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-gzip-json-unsuccessfully/atlas-doc.adoc[]

=== Stop Point Versions

==== Data Mapping Migration from DiDok to ATLAS-PRM

See https://confluence.sbb.ch/x/GI3aj to get additional information about the data mapping migration from DiDok to ATLAS.

=== Trigger export Stop Point Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-stop-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Stop Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-stop-point-json-successfully/atlas-doc.adoc[]

=== Download Stop Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-stop-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Stop Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-stop-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Stop Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-stop-point-gzip-json-successfully/curl-request.adoc[]

=== Platform Versions

=== Trigger Export Platform Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-platform-export-batch-successfully/atlas-doc.adoc[]

=== Get Platform Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-platform-json-successfully/atlas-doc.adoc[]

=== Download Platform Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-platform-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Platform Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-platform-json-successfully/atlas-doc.adoc[]

=== Download Latest Platform Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-platform-gzip-json-successfully/curl-request.adoc[]

=== Reference Point Versions

=== Trigger Export Reference Point Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-reference-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Reference Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-reference-point-json-successfully/atlas-doc.adoc[]

=== Download Reference Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-reference-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Reference Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-reference-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Reference Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-reference-point-gzip-json-successfully/curl-request.adoc[]

=== Contact Point Versions

=== Trigger Export Contact Point Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-contact-point-export-batch-successfully/atlas-doc.adoc[]

=== Get Contact Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-contact-point-json-successfully/atlas-doc.adoc[]

=== Download Contact Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-contact-point-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Contact Point Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-contact-point-json-successfully/atlas-doc.adoc[]

=== Download Latest Contact Point Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-contact-point-gzip-json-successfully/curl-request.adoc[]

=== Toilet Versions

=== Trigger Export Toilet Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-toilet-export-batch-successfully/atlas-doc.adoc[]

=== Get Toilet Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-toilet-json-successfully/atlas-doc.adoc[]

=== Download Toilet Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-toilet-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Toilet Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-toilet-json-successfully/atlas-doc.adoc[]

=== Download Latest Toilet Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-toilet-gzip-json-successfully/curl-request.adoc[]

=== Parking Lot Versions

=== Trigger Export Parking Lot Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-parking-lot-export-batch-successfully/atlas-doc.adoc[]

=== Get Parking Lot Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-parking-lot-json-successfully/atlas-doc.adoc[]

=== Download Parking Lot Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-parking-lot-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Parking Lot Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-parking-lot-json-successfully/atlas-doc.adoc[]

=== Download Latest Parking Lot Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-parking-lot-gzip-json-successfully/curl-request.adoc[]

=== Relation Versions

=== Trigger Export Relation Versions

include::{snippets}/export-prm-batch-controller-api-v1-integration-test/should-post-relation-export-batch-successfully/atlas-doc.adoc[]

=== Get Relation Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-get-relation-json-successfully/atlas-doc.adoc[]

=== Download Relation Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-relation-gzip-json-successfully/curl-request.adoc[]

=== Download Latest Relation Json - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-relation-json-successfully/atlas-doc.adoc[]

=== Download Latest Relation Gzip (Json) - Successfully

include::{snippets}/prm-batch-controller-api-v1-integration-test/should-download-latest-relation-gzip-json-successfully/curl-request.adoc[]
