<atlas-detail-page-container scrollToTop>
  <atlas-detail-page-content>
    <div class="detail-wrapper mt-5">
      <h1 *ngIf="!showSwitch; else detailPageTitle" class="font-bold-4xl mb-5">
        {{ 'LIDI.LINE.NEW' | translate }}
      </h1>
      <ng-template #detailPageTitle>
        <div class="font-bold-4xl detail-title mb-3">
          {{ record.number ?? ''}} - {{ record.description ?? '' }}
        </div>
        <div class="font-bold-xl mb-2">
          <span data-cy="detail-subheading-id">{{ record.slnid! }}</span>
          <span data-cy="total-range">
            -
            <date-range-text [dateRange]="maxValidity"></date-range-text>
          </span>
        </div>
      </ng-template>
      <div class="col-12 d-flex mt-3">
        <div class="d-flex flex-column col-9 pe-3">
          <app-switch-version
            (switchVersion)="switchVersion($event)"
            *ngIf="showSwitch"
            [currentRecord]="record!"
            [records]="records!"
            [switchDisabled]="form.enabled"
          ></app-switch-version>
        </div>
        <div class="d-flex flex-column col-9">
          <app-coverage
            [currentRecord]="record!"
            [pageType]="getPageType()"
          ></app-coverage>
        </div>
      </div>

      <div *ngIf="isExistingRecord()" class="form-title-section my-5">
        <h2 class="font-bold-2xl color-gray-900">
          {{ 'LIDI.DETAIL_LINE_INFORMATION' | translate }} -
          {{ 'COMMON.VERSION' | translate }}
          {{ versionNumberOfCurrentRecord }}
        </h2>
        <div>
          <span class="font-bold-lg color-gray-900"
            >{{ 'COMMON.STATUS' | translate }}
          </span>
          <span class="color-gray-900">{{
            'COMMON.STATUS_TYPES.' + statusOfCurrentRecord | translate
          }}</span>
          <ng-container
            #additionalInfo
            *ngTemplateOutlet="additionalInfo"
          ></ng-container>
        </div>
        <div *ngIf="form.disabled">
          <app-workflow
            *ngIf="isWorkflowable()"
            [descriptionForWorkflow]="getDescriptionForWorkflow()"
            [lineRecord]="record"
            (workflowEvent)="reloadRecord()"
          ></app-workflow>
        </div>
      </div>
      <ng-template #additionalInfo>
        <span class="ps-3 font-bold-lg color-gray-900"
          >{{ 'LIDI.TYPE' | translate }}
        </span>
        <span class="color-gray-900" data-cy="lineTypeReadOnly">{{
          'LIDI.LINE.TYPES.' + lineType | translate
        }}</span>
      </ng-template>
      <div class="workflow-link mb-3" *ngIf="isShowLineSnapshotHistory">
        <atlas-link
          label="LIDI.LINE_VERSION_SNAPSHOT.NAVIGATE_TO_SNAPHOT"
          (linkClicked)="navigateToSnapshot()"
        ></atlas-link>
      </div>
      <line-detail-form
        [boSboidRestriction]="getBoSboidRestriction()"
        [form]="form"
        [newRecord]="this.isNewRecord()"
        [isLineConcessionTypeRequired]="isLineConcessionTypeRequired"
      ></line-detail-form>
      <div class="mt-5">
        <app-user-detail-info
          *ngIf="isExistingRecord()"
          [record]="record"
        ></app-user-detail-info>
      </div>
    </div>
  </atlas-detail-page-content>

  <atlas-detail-footer>
    <atlas-button
      (click)="backToOverview()"
      [footerEdit]="form.enabled"
      buttonDataCy="back-to-overview"
      buttonText="COMMON.BACK_TO_OVERVIEW"
      buttonType="whiteFooterNonEdit"
    >
    </atlas-button>
    <atlas-button
      (buttonClicked)="toggleEdit()"
      [footerEdit]="form.enabled"
      buttonDataCy="cancel"
      buttonText="COMMON.CANCEL"
      buttonType="whiteFooterEdit"
      wrapperStyleClass="me-3"
    >
    </atlas-button>
    <atlas-button
      (click)="save()"
      [disabled]="!form.dirty"
      [footerEdit]="form.enabled"
      [submitButton]="true"
      buttonDataCy="save-item"
      buttonText="COMMON.SAVE"
      buttonType="whiteFooterEdit"
    >
    </atlas-button>
    <ng-container *ngIf="isExistingRecord()">
      <div *ngIf="isEditButtonVisible()">
        <atlas-button
          (buttonClicked)="toggleEdit()"
          applicationType="LIDI"
          [businessOrganisation]="record.businessOrganisation!"
          [disabled]="form.enabled || record.status === 'REVOKED'"
          buttonDataCy="edit-item"
          buttonText="COMMON.EDIT"
          buttonType="edit"
          wrapperStyleClass="ms-3"
        ></atlas-button>
      </div>
      <atlas-button
        (buttonClicked)="revoke()"
        applicationType="LIDI"
        [disabled]="form.enabled || record.status === 'REVOKED'"
        buttonDataCy="revoke-item"
        buttonText="COMMON.REVOKE"
        buttonType="revoke"
        wrapperStyleClass="ms-3"
      >
      </atlas-button>
      <atlas-button
        (buttonClicked)="delete()"
        [disabled]="form.enabled"
        buttonDataCy="delete-item"
        buttonText="COMMON.DELETE"
        buttonType="delete"
        wrapperStyleClass="ms-3"
      >
      </atlas-button>
    </ng-container>
  </atlas-detail-footer>
</atlas-detail-page-container>
