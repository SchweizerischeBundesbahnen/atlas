<div class="detail-wrapper">
  <app-dialog-close
    (clicked)="controller.form.disabled ? controller.backToOverview() : controller.toggleEdit()"
  ></app-dialog-close>

  <h1 *ngIf="!controller.showSwitch; else detailPageTitle" class="font-bold-4xl mb-5">
    {{ headingNew | translate }}
  </h1>
  <ng-template #detailPageTitle>
    <div class="font-bold-4xl detail-title mb-3">
      {{ controller.getDetailHeading(controller.record) }}
    </div>
    <div class="font-bold-xl mb-2">
      <span data-cy="detail-subheading-id">{{
        controller.getDetailSubheading(controller.record)
      }}</span>
      <span data-cy="total-range">
        - {{ 'COMMON.VALID_FROM' | translate }}
        {{ controller.getStartDate() }}
        {{ 'COMMON.TO' | translate }}
        {{ controller.getEndDate() }}</span
      >
    </div>
  </ng-template>
  <div class="col-12 d-flex mt-3">
    <div class="d-flex flex-column col-7 pe-3">
      <app-switch-version
        *ngIf="controller.showSwitch"
        [records]="controller.records!"
        [currentRecord]="controller.record!"
        [switchDisabled]="controller.form.enabled"
        (switchVersion)="controller.switchVersion($event)"
      ></app-switch-version>
    </div>
    <div class="d-flex flex-column col-5 pe-3">
      <app-coverage
        [currentRecord]="controller.record!"
        [pageType]="controller.getPageType()"
      ></app-coverage>
    </div>
  </div>
  <div *ngIf="controller.isExistingRecord()" class="edit-section">
    <atlas-button
      buttonType="edit"
      [applicationType]="this.controller.getApplicationType()"
      [businessOrganisation]="selectedRecord.businessOrganisation!"
      buttonDataCy="edit-item"
      (buttonClicked)="controller.toggleEdit()"
      [disabled]="controller.form.enabled"
      buttonText="COMMON.EDIT_VERSION"
      wrapperStyleClass="me-3"
    >
    </atlas-button>
    <atlas-button
      buttonType="revoke"
      [applicationType]="this.controller.getApplicationType()"
      buttonDataCy="revoke-item"
      (buttonClicked)="controller.revoke()"
      [disabled]="controller.form.enabled || controller.record.status === 'REVOKED'"
      buttonText="COMMON.REVOKE"
      wrapperStyleClass="me-3"
    >
    </atlas-button>
    <atlas-button
      buttonType="delete"
      buttonDataCy="delete-item"
      (buttonClicked)="controller.delete()"
      [disabled]="controller.form.enabled"
      buttonText="COMMON.DELETE"
    >
    </atlas-button>
  </div>

  <div *ngIf="controller.isExistingRecord()" class="form-title-section">
    <h2 class="font-bold-2xl color-gray-900">
      {{ formDetailHeading | translate }} - {{ 'COMMON.VERSION' | translate }}
      {{ controller.versionNumberOfCurrentRecord }}
    </h2>
    <div>
      <span class="font-bold-lg color-gray-900">{{ 'COMMON.STATUS' | translate }} </span>
      <span class="color-gray-900">{{
        'COMMON.STATUS_TYPES.' + controller.statusOfCurrentRecord | translate
      }}</span>
    </div>
  </div>

  <div>
    <ng-content></ng-content>
  </div>

  <div class="footer fixed-bottom d-flex align-items-center justify-content-center">
    <ng-template [ngIf]="controller.form.disabled">
      <atlas-button
        buttonType="footer"
        [mat-dialog-close]="true"
        buttonDataCy="back-to-overview"
        buttonText="COMMON.BACK_TO_OVERVIEW"
      >
      </atlas-button>
    </ng-template>
    <ng-template [ngIf]="!controller.form.disabled">
      <atlas-button
        buttonType="footer"
        (buttonClicked)="controller.toggleEdit()"
        buttonDataCy="cancel"
        buttonText="COMMON.CANCEL"
        wrapperStyleClass="me-3"
      >
      </atlas-button>
      <atlas-button
        buttonType="footer"
        buttonDataCy="save-item"
        [submitButton]="true"
        (click)="controller.save()"
        [disabled]="!controller.form.dirty"
        buttonText="COMMON.SAVE"
      >
      </atlas-button>
    </ng-template>
  </div>
</div>
